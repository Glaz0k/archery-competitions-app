# Контроллер для управления кубками

## Управление кубками

### `POST /cups`

> Добавляет новый кубок

_Уровень доступа:_ `[organizer]`\
_Тело запроса:_

```json
{
  "title": "Открытый зимний кубок \"Стрелы парадокса\"",
  "address": "г. Санкт-Петербург, ЛК \"Парадокс Лучника\"",
  "season": "2024/2025"
}
```

_Ответы:_

- **Успешно**\
  `201 Created`\
  [`cup.json`](../models/cup.md)
- [**Неверные параметры кубка**](user_errors.md/#неверные-параметры)

### `GET /cups/{cup_id}`

> Получает кубок (участник получает, если принимает участие)

_Уровень доступа:_ `[organizer, competitor]`\
_Переменные пути:_

- `cup_id` - id кубка

_Ответы:_

- **Успешно**\
  `200 Ok`\
  [`cup.json`](../models/cup.md)
- [**Кубок не найден**](user_errors.md/#не-найдено)

### `GET /cups`

> Получает кубки, доступные пользователю (участник получает только те, в которых принимает участие)

_Уровень доступа:_ `[organizer, competitor]`\
_Ответы:_

- **Успешно**\
  `200 Ok`\
  `[`[`cup.json`](../models/cup.md)`]`

### `PUT /cups/{cup_id}`

> Изменяет существующий кубок

_Уровень доступа:_ `[organizer]`\
_Переменные пути:_

- `cup_id` - id кубка

_Тело запроса:_

```json
{
  "title": "Открытый зимний кубок \"Стрелы парадокса\"",
  "address": "г. Санкт-Петербург, ЛК \"Парадокс Лучника\"",
  "season": "2023/2024"
}
```

_Ответы:_

- **Успешно**\
  `200 Ok`
  ```json
  {
    "id": 17,
    "title": "Открытый зимний кубок \"Стрелы парадокса\"",
    "address": "г. Санкт-Петербург, ЛК \"Парадокс Лучника\"",
    "season": "2023/2024"
  }
  ```
- [**Неверные параметры кубка**](user_errors.md/#неверные-параметры)
- [**Кубок не найден**](user_errors.md/#не-найдено)

### `DELETE /cups/{cup_id}`

> [!WARNING]
> Безвозвратно удаляет кубок. Является каскадным удалением и должно помимо самого кубка удалить все сопутсвующие с ним соревнования.

_Уровень доступа:_ `[organizer]`\
_Переменные пути:_

- `cup_id` - id кубка

_Ответы:_

- **Успешно**\
  `204 No content`

## Управление соревнованиями (на уровне кубка)

### `POST /cups/{cup_id}/competitions`

> Добавляет новое соревнование в кубок

_Уровень доступа:_ `[organizer]`\
_Переменные пути:_

- `cup_id` - id кубка

_Тело запроса:_

```json
{
  "stage": "III",
  "start_date": "2025-01-18",
  "end_date": "2025-01-19"
}
```

_Ответы:_

- **Успешно создан**\
  `201 Created`\
  [`competition.json`](../models/competition.md)
- [**Соревнование с таким этапом у кубка уже существует**](user_errors.md/#ресурс-уже-существует)
- [**Неверные параметры соревнования**](user_errors.md/#неверные-параметры)
- [**Кубок не найден**](user_errors.md/#не-найдено)

### `GET /cups/{cup_id}/competitions`

> Получает все соревнования, доступные пользователю (участник получает только те, в которых принимает участие)

_Уровень доступа:_ `[organizer, competitor]`\
_Переменные пути:_

- `cup_id` - id кубка

_Ответы:_

- **Успешно**\
  `200 Ok`\
  `[`[`competition.json`](../models/competition.md)`]`
- [**Кубок не найден**](user_errors.md/#не-найдено)
